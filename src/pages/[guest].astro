---
import Banner from "@components/organisms/Banner/Banner.astro";
import Date from "@components/organisms/Date/Date.astro";
import DressCode from "@components/organisms/DressCode/DressCode.astro";
import Gifts from "@components/organisms/Gifts/Gifts.astro";
import GuestSection from "@components/organisms/Guest/Guest.astro";
import Location from "@components/organisms/Location/Location.astro";
import Table from "@components/organisms/Table/Table.astro";
import Timeline from "@components/organisms/Timeline/Timeline.astro";
import Layout from "@layouts/Layout.astro";
import type { Guest } from "@models/types/guest";
import divider1Image from "@public/images/divider--1.png";
import divider2Image from "@public/images/divider--2.png";
import { Image } from "astro:assets";
import { tables } from "../data.json";
import Photo from "@components/atoms/Photo.astro";
import Reminder from "@components/organisms/Reminder/Reminder.astro";

export const allGuests: Guest[] = tables.flat();

const guestParam: string = Astro.params.guest;

const guest: Guest | undefined = allGuests.find(
  (g: Guest) => g.id === guestParam
);

export function getStaticPaths() {
  return allGuests.map((guest: Guest) => ({
    params: { guest: guest.id },
  }));
}
---

<Layout guest={guest}>
  <Banner />
  {guest && <GuestSection guest={guest} />}
  <Date />
  <Location />
  <DressCode />
  <Photo />
  <Image class="divider divider--1" src={divider1Image} alt="Divider" />
  <Timeline />
  <Image class="divider divider--2" src={divider2Image} alt="Divider" />
  <Gifts />
  {guest && <Reminder guest={guest} />}
  {guest && <Table guest={guest} />}
</Layout>

<style>
  .divider {
    height: auto;
    margin: 0 auto;
  }

  .divider--1,
  .divider--2 {
    width: min(27.1875rem, 70%);
  }
</style>
